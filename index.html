<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>VSPhone ‚Äì Qu·∫£n l√Ω & Buff</title>
<style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; padding: 20px; }
    .card { max-width: 1100px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    h2 { color: #1c1e21; border-bottom: 2px solid #eee; padding-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #e0e0e0; padding: 12px; text-align: left; }
    th { background: #f8f9fa; font-weight: 600; }
    .btn { padding: 6px 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
    .btn-login { background: #5865f2; color: white; }
    .btn-buff { background: #3ba55d; color: white; margin-left: 5px; }
    .btn:hover { opacity: 0.8; transform: translateY(-1px); }
    .input-id { padding: 8px; border: 1px solid #ddd; border-radius: 4px; width: 180px; margin-right: 10px; }
</style>
</head>
<body>

<div class="card">
    <h2>üöÄ VSPhone Account Manager</h2>
    <div style="margin-bottom: 15px;">
        <input type="text" id="globalChannelId" class="input-id" placeholder="Nh·∫≠p Channel ID m·∫∑c ƒë·ªãnh...">
        <small style="color: #666;">(D√πng khi h√†ng trong Sheet kh√¥ng c√≥ ID)</small>
    </div>

    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>N·ªÅn t·∫£ng</th>
                <th>Email</th>
                <th>M·∫≠t kh·∫©u</th>
                <th>Thao t√°c</th>
            </tr>
        </thead>
        <tbody id="tbody">
            <tr><td colspan="5" style="text-align:center;">ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Google Sheets...</td></tr>
        </tbody>
    </table>
</div>

<script>
const SHEET_URL = 'https://opensheet.elk.sh/1fU4ppbOWDikPkEWUdXiyqrUn8JHXvt-PJjS778J-R8M/Trang%20t%C3%ADnh1';

async function loadData() {
    try {
        const res = await fetch(SHEET_URL);
        const data = await res.json();
        const tbody = document.querySelector('#tbody');
        tbody.innerHTML = '';

        data.forEach((row, i) => {
            if (!row.email) return;
            // Gi·∫£ s·ª≠ c·ªôt ID k√™nh trong sheet t√™n l√† 'channel_id'
            const channelId = row.channel_id || ''; 
            
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${i + 1}</td>
                <td><strong>${row.platform || 'Discord'}</strong></td>
                <td>${row.email}</td>
                <td style="font-family:monospace; color:#d63031;">${row.password}</td>
                <td>
                    <button class="btn btn-login" onclick="login('${row.email}','${row.password}')">ƒêƒÇNG NH·∫¨P</button>
                    <button class="btn btn-buff" onclick="buff('${channelId}')">üî• BUFF</button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    } catch (e) {
        document.querySelector('#tbody').innerHTML = '<tr><td colspan="5">‚ùå L·ªói k·∫øt n·ªëi d·ªØ li·ªáu</td></tr>';
    }
}

function login(email, pass) {
    const win = window.open('https://cloud.vsphone.com/login', '_blank');
    setTimeout(() => {
        win.postMessage({ type: 'AUTO_LOGIN', email, password: pass }, 'https://cloud.vsphone.com');
    }, 2000);
}

function buff(rowChannelId) {
    const globalId = document.getElementById('globalChannelId').value;
    const finalId = rowChannelId || globalId;

    if (!finalId) {
        alert("Vui l√≤ng nh·∫≠p Channel ID!");
        return;
    }
    // M·ªü link k√®m tham s·ªë buff=true
    window.open(`https://discord.com/channels/@me/${finalId}?buff=true`, '_blank');
}

loadData();
</script>
</body>
</html>
