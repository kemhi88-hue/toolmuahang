<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Create Order - Hoang Cloud</title>
  <style>
    body {
      font-family: Arial;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
    input, textarea, button {
      width: 100%;
      margin: 6px 0;
      padding: 8px;
    }
    textarea { height: 100px; }
    pre {
      background: #111;
      color: #0f0;
      padding: 10px;
    }
  </style>
</head>
<body>

<h2>üõí T·∫°o ƒë∆°n h√†ng (create_order)</h2>

<label>Token</label>
<input id="token" value="0d64ac97f0e52fe735af6639c23ccf71303f6d13f6a414">

<label>Product ID</label>
<input id="product_id" value="ID14">

<label>S·ªë l∆∞·ª£ng</label>
<input id="quantity" type="number" value="1">

<label>Input data (n·∫øu c√≥)</label>
<textarea id="input_data"></textarea>

<button onclick="createOrder()">üöÄ T·∫°o ƒë∆°n</button>

<h3>K·∫øt qu·∫£</h3>
<pre id="result"></pre>

<script>
async function createOrder() {
  const payload = {
    token: document.getElementById("token").value,
    product_id: document.getElementById("product_id").value,
    quantity: Number(document.getElementById("quantity").value),
    input_data: document.getElementById("input_data").value
  };

  const resultEl = document.getElementById("result");
  resultEl.textContent = "‚è≥ ƒêang g·ª≠i request...\n";

  try {
    const res = await fetch("https://hoang.cloud/dev/create_order", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    // Log HTTP status
    resultEl.textContent += `HTTP Status: ${res.status}\n`;

    const text = await res.text();

    // Log raw response
    resultEl.textContent += `Raw response:\n${text}\n`;

    // Th·ª≠ parse JSON
    try {
      const data = JSON.parse(text);
      resultEl.textContent += "\nParsed JSON:\n" +
        JSON.stringify(data, null, 2);

      // L∆∞u order_id
      if (data?.data?.order_id) {
        let orders = JSON.parse(localStorage.getItem("orders") || "[]");
        orders.push({
          time: new Date().toISOString(),
          product_id: payload.product_id,
          order_id: data.data.order_id
        });
        localStorage.setItem("orders", JSON.stringify(orders));
      }
    } catch (jsonErr) {
      resultEl.textContent +=
        "\n‚ö†Ô∏è Kh√¥ng parse ƒë∆∞·ª£c JSON (response kh√¥ng ph·∫£i JSON)";
    }

  } catch (err) {
    // FETCH FAILED
    resultEl.textContent +=
`‚ùå FETCH FAILED
T√™n l·ªói: ${err.name}
Message: ${err.message}

üëâ Kh·∫£ nƒÉng cao:
- API b·ªã CORS block
- Server kh√¥ng cho g·ªçi tr·ª±c ti·∫øp t·ª´ browser
- M·∫°ng b·ªã ch·∫∑n / DNS l·ªói

üëâ Test nhanh:
- M·ªü DevTools (F12) ‚Üí Network ‚Üí xem request c√≥ xu·∫•t hi·ªán kh√¥ng
- Th·ª≠ g·ªçi b·∫±ng Postman / curl
`;
  }
}
</script>


</body>
</html>

