<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>VSPhone Local Dashboard</title>
    <style>
        :root { --primary: #5865f2; --success: #3ba55d; --bg: #f3f4f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); padding: 20px; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border-bottom: 1px solid #edf2f7; text-align: left; }
        th { background: #f8fafc; color: #64748b; font-size: 11px; text-transform: uppercase; }
        .btn { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; font-size: 11px; }
        .btn-login { background: var(--primary); }
        .btn-buff { background: var(--success); }
        .invite-link { font-family: monospace; font-size: 11px; color: #2ecc71; font-weight: bold; }
        .input-channel { padding: 5px; border: 1px solid #ddd; border-radius: 4px; width: 150px; }
    </style>
</head>
<body>

<div class="container">
    <h2>üöÄ Dashboard L∆∞u T·∫°i Ch·ªó</h2>
    <p style="font-size: 12px; color: #666;">D·ªØ li·ªáu l∆∞u tr·ª±c ti·∫øp tr√™n tr√¨nh duy·ªát c·ªßa b·∫°n (LocalStorage).</p>

    <table id="accountTable">
        <thead>
            <tr>
                <th>#</th>
                <th>Email</th>
                <th>Password</th>
                <th>Channel ID</th>
                <th>M√£ m·ªùi ƒë√£ nh·∫∑t</th>
                <th>Thao t√°c</th>
            </tr>
        </thead>
        <tbody id="tbody"></tbody>
    </table>
</div>

<script>
// Danh s√°ch t√†i kho·∫£n c·ªßa b·∫°n (B·∫°n c√≥ th·ªÉ th√™m b·ªõt ·ªü ƒë√¢y)
const MY_ACCOUNTS = [
    { email: "email1@gmail.com", pass: "pass1" },
    { email: "email2@gmail.com", pass: "pass2" },
    // Th√™m c√°c d√≤ng kh√°c t∆∞∆°ng t·ª±...
];

let currentEmail = null;
let currentIndex = null;

// 1. H√ÄM LOAD D·ªÆ LI·ªÜU T·ª™ B·ªò NH·ªö TR√åNH DUY·ªÜT
function renderTable() {
    const tbody = document.getElementById('tbody');
    tbody.innerHTML = '';

    MY_ACCOUNTS.forEach((acc, i) => {
        // L·∫•y d·ªØ li·ªáu c≈© ƒë√£ l∆∞u (n·∫øu c√≥)
        const savedInvite = localStorage.getItem(`INVITE_${acc.email}`) || "Ch·ªù nh·∫∑t m√£...";
        const savedChannel = localStorage.getItem(`CHANNEL_${acc.email}`) || "";

        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${i + 1}</td>
            <td><strong>${acc.email}</strong></td>
            <td>${acc.pass}</td>
            <td><input type="text" class="input-channel" id="channel-${i}" value="${savedChannel}" onchange="saveChannel('${acc.email}', this.value)" placeholder="D√°n ID k√™nh..."></td>
            <td class="invite-link" id="invite-res-${i}">${savedInvite}</td>
            <td>
                <button class="btn btn-login" onclick="login('${acc.email}','${acc.pass}', ${i})">LOGIN</button>
                <button class="btn btn-buff" onclick="buff('${acc.email}', ${i})">BUFF</button>
            </td>
        `;
        tbody.appendChild(tr);
    });
}

// 2. L·∫ÆNG NGHE USERSCRIPT G·ª¨I M√É V·ªÄ
setInterval(() => {
    const collectedLink = localStorage.getItem('VS_LAST_COLLECTED_LINK');
    
    if (collectedLink && currentEmail) {
        // L∆∞u v√†o b·ªô nh·ªõ m√°y t√≠nh
        localStorage.setItem(`INVITE_${currentEmail}`, collectedLink);
        
        // C·∫≠p nh·∫≠t giao di·ªán
        const cell = document.getElementById(`invite-res-${currentIndex}`);
        if(cell) cell.innerText = collectedLink;

        // X√≥a link t·∫°m
        localStorage.removeItem('VS_LAST_COLLECTED_LINK');
        currentEmail = null;
        alert("‚úÖ ƒê√£ nh·∫∑t v√† l∆∞u m√£ th√†nh c√¥ng!");
    }
}, 1000);

function login(email, pass, index) {
    currentIndex = index;
    currentEmail = email;
    const win = window.open('https://cloud.vsphone.com/login', '_blank');
    setTimeout(() => {
        win.postMessage({ type: 'AUTO_LOGIN', email, password: pass }, 'https://cloud.vsphone.com');
        setTimeout(() => { win.location.href = "https://cloud.vsphone.com/share/invite"; }, 3000);
    }, 2000);
}

function saveChannel(email, val) {
    localStorage.setItem(`CHANNEL_${email}`, val);
}

function buff(email, index) {
    const invite = localStorage.getItem(`INVITE_${email}`);
    const channelId = document.getElementById(`channel-${index}`).value;

    if (!invite) return alert("Ch∆∞a c√≥ m√£ m·ªùi!");
    if (!channelId) return alert("H√£y nh·∫≠p Channel ID!");

    window.open(`https://discord.com/channels/@me/${channelId}?buff=true`, '_blank');
}

renderTable();
</script>
</body>
</html>
